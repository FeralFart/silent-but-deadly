  GNU nano 8.4                                                          docker-compose.yml
services:
  netalertx:
    container_name: netalertx
    image: ghcr.io/jokob-sk/netalertx:latest
    network_mode: ${NETALERTX_NETWORK_MODE:-host}   # host networking required for ARP scanning
    user: "0"                                         # run as root to avoid permission issues
    read_only: false                                # allow writing to container filesystem

    cap_add:
      - NET_ADMIN
      - NET_RAW
      - NET_BIND_SERVICE

    volumes:
      # Persistent data storage
      - ./data/db:/data/db:rw
      - ./data/config:/data/config:rw

      # Fully writable tmp directories for logs, API, nginx, runtime
      - ./tmp/log:/tmp/log:rw
      - ./tmp/run/tmp:/tmp/run/tmp:rw
      - ./tmp/api:/tmp/api:rw
      - ./tmp/nginx/active-config:/tmp/nginx/active-config:rw

      # Timezone sync
      - /etc/localtime:/etc/localtime:ro

    environment:
      LISTEN_ADDR: ${LISTEN_ADDR:-0.0.0.0}
      PORT: ${PORT:-20211}
      GRAPHQL_PORT: ${GRAPHQL_PORT:-20212}

    mem_limit: 2048m
    mem_reservation: 1024m
    cpu_shares: 512
    pids_limit: 512

    logging:
      driver: "json-file"
      options:
        max-size: "10m"
        max-file: "3"

    restart: unless-stopped